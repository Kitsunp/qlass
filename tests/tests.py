#TODO: add some tests for the helper functions and hamiltonian functions